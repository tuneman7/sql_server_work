{
   "customers": [
      {
         "populate_customer_product_history.sql": "/data/school/MIDS/sql_server_work/fastapi/products/db_artifacts/mysql/queries/customers/populate_customer_product_history.sql",
         "populate_customer_product_history.sql_content": "INSERT INTO customers.customer_product_history\n    (product_id, customer_id, product_type_desc, purchase_dt, expiration_dt, created_by, created_dt, updated_by, updated_dt)\nSELECT\n    product_id,\n    customer_id,\n    product_type_desc,\n    (expiration_dt - INTERVAL (DATEDIFF(expiration_dt, purchase_dt) + 1) DAY) AS purchase_dt,\n    (purchase_dt) AS expiration_dt,\n    created_by,\n    created_dt,\n    updated_by,\n    updated_dt\nFROM\n    customers.customer_product\nWHERE\n    RAND() <= 0.8; -- Select 80% of records randomly    \n\n"
      }
   ]
}